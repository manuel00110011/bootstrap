<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Progress Bar con Spinner nel Bottone</title>

  <!-- Bootstrap CSS -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
    rel="stylesheet"
  >
</head>
<body class="p-5">

  <h4>Upload in corso</h4>

  <!-- Progress bar -->
  <div class="progress mt-3" style="height: 25px;">
    <div id="progressBar"
         class="progress-bar progress-bar-striped progress-bar-animated bg-success"
         role="progressbar"
         style="width: 0%"
         aria-valuenow="0"
         aria-valuemin="0"
         aria-valuemax="100">
      0%
    </div>
  </div>

  <!-- Bottone di caricamento -->
  <button class="btn btn-primary mt-4" id="btnLoad">
    Avvia caricamento
  </button>

  <script>
    const btn = document.getElementById("btnLoad");
    const progressBar = document.getElementById("progressBar");

    btn.addEventListener("click", () => {
      let value = 0;

      // Disabilita il bottone
      btn.disabled = true;

      // Inserisce spinner + testo nel bottone
      btn.innerHTML = `
        <span class="spinner-border spinner-border-sm me-2" role="status">
          <span class="visually-hidden">Caricamento in corso</span>
        </span>
        Caricamento...
      `;

      // Avvio progress bar
      const interval = setInterval(() => {
        value += 10;
        progressBar.style.width = value + "%";
        progressBar.textContent = value + "%";
        progressBar.setAttribute("aria-valuenow", value);

        if (value >= 100) {
          clearInterval(interval);

          // Stop animazione della progress bar
          progressBar.classList.remove("progress-bar-animated");
          progressBar.textContent = "Completato";

          // Riporta il bottone al testo originale e lo abilita
          btn.disabled = false;
          btn.textContent = "Avvia caricamento";
        }
      }, 500);
    });
  </script>

</body>
</html>
